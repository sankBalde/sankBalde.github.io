import './polyfills.server.mjs';
import{a as q}from"./chunk-MUGL7ENK.mjs";import{p as N}from"./chunk-A54HIVKK.mjs";import{e as H,g as L,j as D,q as $}from"./chunk-CANKRD7P.mjs";import{Cb as s,Db as V,Eb as S,Ia as a,Ra as F,T as w,Wa as v,Y as c,Z as p,ea as x,lb as _,mb as o,nb as r,pb as I,qb as A,rb as y,sb as g,tb as f,vc as k,wc as M,yc as C,zb as b}from"./chunk-OC75U52M.mjs";import{a as h,b as T}from"./chunk-N7QBYMCK.mjs";function j(d,i){if(d&1&&(o(0,"p",15),s(1),r()),d&2){f();let e=b(12);a(),S(" ",e.title," ")}}function P(d,i){if(d&1&&(o(0,"p",15),s(1),r()),d&2){f();let e=b(10);a(),S(" ",e.title," ")}}function z(d,i){if(d&1){let e=y();o(0,"label",25)(1,"input",26),g("change",function(t){let l=c(e).$implicit,u=f().index,m=f();return p(m.onToggleSection(u,l,t))}),r(),o(2,"span"),s(3),r()()}if(d&2){let e=i.$implicit,n=f().$implicit;a(),_("checked",n.sections.includes(e)),a(2),V(e)}}function Z(d,i){if(d&1){let e=y();I(0),o(1,"div",16)(2,"div",17)(3,"label",18),s(4,"Titre du module"),r(),o(5,"input",19),g("input",function(t){let l=c(e).index,u=f();return p(u.onModuleTitleInput(l,t))})("keydown.enter",function(t){c(e);let l=f();return p(l.focusNext(t))}),r()(),o(6,"div",17)(7,"label",18),s(8,"Slug"),r(),o(9,"input",20,0),g("input",function(t){let l=c(e).index,u=f();return p(u.onModuleSlugInput(l,t))}),r(),v(11,P,2,1,"p",7),r(),o(12,"div",17)(13,"label",21),s(14,"Sections"),r(),o(15,"div",22),v(16,z,4,2,"label",23),r()(),o(17,"button",24),g("click",function(){let t=c(e).index,l=f();return p(l.removeModule(t))}),s(18," \u2716 "),r()(),A()}if(d&2){let e=i.$implicit,n=b(10),t=f();a(5),_("value",e.title),a(4),_("value",e.slug),a(2),_("ngIf",n.validity&&!n.validity.valid&&n.value!==""),a(5),_("ngForOf",t.allSections),a(),_("disabled",t.modules().length===1)}}var O=class d{router=w(N);courseService=w(q);title=x("");desc=x("");slug=x("");allSections=["Tutoriels","QCM","Exercices","Projets"];modules=x([{slug:"",title:"",sections:[...this.allSections]}]);addModule(){this.modules.update(i=>[...i,{slug:"",title:"",sections:[...this.allSections]}])}removeModule(i){this.modules().length!==1&&this.modules.update(e=>e.filter((n,t)=>t!==i))}onTitleInput(i){let e=i.target;e&&this.title.set(e.value)}onSlugInput(i){let e=i.target;e&&this.slug.set(e.value)}onDescInput(i){let e=i.target;e&&this.desc.set(e.value)}onModuleTitleInput(i,e){let n=e.target;if(!n)return;let t=this.modules();t[i].title=n.value,this.modules.set([...t])}onModuleSlugInput(i,e){let n=e.target;if(!n)return;let t=this.modules();t[i].slug=n.value,this.modules.set([...t])}onToggleSection(i,e,n){let t=n.target;if(!t)return;let l=t.checked;this.modules.update(u=>{let m=[...u],E=new Set(m[i].sections);return l?E.add(e):E.delete(e),m[i]=T(h({},m[i]),{sections:Array.from(E)}),m})}focusNext(i){let e=i;if(e.key!=="Enter")return;e.preventDefault();let n=e.target.closest("form");if(!n)return;let t=Array.from(n.querySelectorAll("input, textarea")).filter(m=>!m.hasAttribute("disabled")&&!m.hidden&&m.offsetParent!==null&&m.getAttribute("type")!=="hidden"),l=t.findIndex(m=>m===e.target);if(l===-1)return;let u=t[l+1];u&&u.focus()}submitFormation(){let i={slug:this.slug(),title:this.title(),desc:this.desc(),modules:this.modules()};this.courseService.createFormation(i).subscribe(()=>{this.router.navigate(["/formations/gestion"])})}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=F({type:d,selectors:[["app-add-formation"]],decls:27,vars:5,consts:[["slugInputEl",""],[1,"max-w-3xl","mx-auto","py-10","px-6"],[1,"text-3xl","font-bold","mb-6","text-center"],[1,"space-y-8",3,"ngSubmit"],[1,"block","mb-1","font-medium"],["name","title","required","",1,"w-full","px-4","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-yellow-500",3,"input","keydown.enter","value"],["name","slug","required","","maxlength","12","pattern","^[a-zA-Z0-9\\-]{1,15}$","title","caract\xE8res alphanumeriques et (-) uniquement",1,"w-full","px-4","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-yellow-500",3,"input","keydown.enter","value"],["class","text-red-600 text-sm mt-1",4,"ngIf"],["name","desc","rows","4","required","",1,"w-full","px-4","py-2","border","rounded","focus:outline-none","focus:ring-2","focus:ring-yellow-500",3,"input","value"],[1,"space-y-6"],[1,"text-xl","font-semibold","mb-2"],[4,"ngFor","ngForOf"],["type","button",1,"bg-blue-600","text-white","px-4","py-2","rounded","hover:bg-blue-700",3,"click"],[1,"text-center"],["type","submit",1,"bg-green-600","text-white","px-6","py-2","rounded","hover:bg-green-700"],[1,"text-red-600","text-sm","mt-1"],[1,"bg-gray-100","p-4","rounded","relative","border"],[1,"mb-3"],[1,"block","text-sm","font-medium"],["required","",1,"w-full","px-3","py-2","border","rounded",3,"input","keydown.enter","value"],["required","","maxlength","12","pattern","^[a-zA-Z0-9\\-]{1,15}$","title","caract\xE8res alphanumeriques et (-) uniquement",1,"w-full","px-3","py-2","border","rounded",3,"input","value"],[1,"block","text-sm","font-medium","mb-1"],[1,"flex","flex-wrap","gap-4"],["class","inline-flex items-center space-x-2",4,"ngFor","ngForOf"],["type","button","title","Supprimer le module",1,"absolute","top-2","right-2","text-red-500","hover:text-red-700",3,"click","disabled"],[1,"inline-flex","items-center","space-x-2"],["type","checkbox",3,"change","checked"]],template:function(e,n){if(e&1){let t=y();o(0,"div",1)(1,"h2",2),s(2,"Ajouter une formation"),r(),o(3,"form",3),g("ngSubmit",function(){return c(t),p(n.submitFormation())}),o(4,"div")(5,"label",4),s(6,"Titre"),r(),o(7,"input",5),g("input",function(u){return c(t),p(n.onTitleInput(u))})("keydown.enter",function(u){return c(t),p(n.focusNext(u))}),r()(),o(8,"div")(9,"label",4),s(10,"Slug de la formation"),r(),o(11,"input",6,0),g("input",function(u){return c(t),p(n.onSlugInput(u))})("keydown.enter",function(u){return c(t),p(n.focusNext(u))}),r(),v(13,j,2,1,"p",7),r(),o(14,"div")(15,"label",4),s(16,"Description"),r(),o(17,"textarea",8),g("input",function(u){return c(t),p(n.onDescInput(u))}),r()(),o(18,"div",9)(19,"h3",10),s(20,"Modules"),r(),v(21,Z,19,5,"ng-container",11),o(22,"button",12),g("click",function(){return c(t),p(n.addModule())}),s(23," + Ajouter un module "),r()(),o(24,"div",13)(25,"button",14),s(26," Cr\xE9er la formation "),r()()()()}if(e&2){let t=b(12);a(7),_("value",n.title()),a(4),_("value",n.slug()),a(2),_("ngIf",t.validity&&!t.validity.valid&&t.value!==""),a(4),_("value",n.desc()),a(4),_("ngForOf",n.modules())}},dependencies:[C,k,M,$,D,H,L],encapsulation:2})};export{O as AddFormation};
