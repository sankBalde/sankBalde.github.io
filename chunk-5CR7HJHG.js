import{a as et}from"./chunk-DBU6QSDP.js";import{c as Ze,f as ce,i as Xe}from"./chunk-2O6BEIAH.js";import{b as tt,c as nt,d as it,i as rt,k as ot,n as st,o as at,p as ct,q as lt}from"./chunk-IAJIG4OQ.js";import{$ as S,$a as ge,A as ie,B as Ne,Ba as H,Bb as $,Ca as qe,Cb as W,Db as z,Eb as se,Fa as b,G as ke,H as Re,Hb as Ce,I as Pe,Ib as ve,J as De,Ja as N,K as Le,L as I,O as w,Oa as oe,Ob as Ye,P as F,Pa as k,R as Y,Ra as Qe,S as J,T as h,Wa as pe,Wb as xe,Y as g,Z as _,a as ee,ab as R,ba as G,bb as P,c as K,cb as je,dc as Je,eb as _e,ec as Ge,f as te,fb as be,gb as V,hb as c,ib as l,ic as ae,jb as He,ka as fe,l as Q,m as M,mb as D,nb as x,oa as re,ob as m,p as v,pa as Be,pb as Ve,q as Te,qb as $e,s as Oe,u as j,v as Fe,vb as We,w as E,wb as ze,xb as d,y as ne,yb as Ue,zb as Ke}from"./chunk-WBYVMQEE.js";import"./chunk-C6Q5SG76.js";var le;function It(){if(le===void 0&&(le=null,typeof window<"u")){let i=window;i.trustedTypes!==void 0&&(le=i.trustedTypes.createPolicy("angular#components",{createHTML:o=>o}))}return le}function Z(i){return It()?.createHTML(i)||i}function dt(i){return Error(`Unable to find icon with the name "${i}"`)}function St(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function ut(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function mt(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}var y=class{url;svgText;options;svgElement;constructor(o,e,t){this.url=o,this.svgText=e,this.options=t}},ft=(()=>{class i{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(e,t,n,r){this._httpClient=e,this._sanitizer=t,this._errorHandler=r,this._document=n}addSvgIcon(e,t,n){return this.addSvgIconInNamespace("",e,t,n)}addSvgIconLiteral(e,t,n){return this.addSvgIconLiteralInNamespace("",e,t,n)}addSvgIconInNamespace(e,t,n,r){return this._addSvgIconConfig(e,t,new y(n,null,r))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,t,n,r){let s=this._sanitizer.sanitize(H.HTML,n);if(!s)throw mt(n);let a=Z(s);return this._addSvgIconConfig(e,t,new y("",a,r))}addSvgIconSet(e,t){return this.addSvgIconSetInNamespace("",e,t)}addSvgIconSetLiteral(e,t){return this.addSvgIconSetLiteralInNamespace("",e,t)}addSvgIconSetInNamespace(e,t,n){return this._addSvgIconSetConfig(e,new y(t,null,n))}addSvgIconSetLiteralInNamespace(e,t,n){let r=this._sanitizer.sanitize(H.HTML,t);if(!r)throw mt(t);let s=Z(r);return this._addSvgIconSetConfig(e,new y("",s,n))}registerFontClassAlias(e,t=e){return this._fontCssClassesByAlias.set(e,t),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){let t=this._sanitizer.sanitize(H.RESOURCE_URL,e);if(!t)throw ut(e);let n=this._cachedIconsByUrl.get(t);return n?Q(de(n)):this._loadSvgIconFromConfig(new y(e,null)).pipe(I(r=>this._cachedIconsByUrl.set(t,r)),v(r=>de(r)))}getNamedSvgIcon(e,t=""){let n=ht(t,e),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);if(r=this._getIconConfigFromResolvers(t,e),r)return this._svgIconConfigs.set(n,r),this._getSvgFromConfig(r);let s=this._iconSetConfigs.get(t);return s?this._getSvgFromIconSetConfigs(e,s):M(dt(n))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Q(de(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(v(t=>de(t)))}_getSvgFromIconSetConfigs(e,t){let n=this._extractIconWithNameFromAnySet(e,t);if(n)return Q(n);let r=t.filter(s=>!s.svgText).map(s=>this._loadSvgIconSetFromConfig(s).pipe(E(a=>{let p=`Loading icon set URL: ${this._sanitizer.sanitize(H.RESOURCE_URL,s.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(p)),Q(null)})));return j(r).pipe(v(()=>{let s=this._extractIconWithNameFromAnySet(e,t);if(!s)throw dt(e);return s}))}_extractIconWithNameFromAnySet(e,t){for(let n=t.length-1;n>=0;n--){let r=t[n];if(r.svgText&&r.svgText.toString().indexOf(e)>-1){let s=this._svgElementFromConfig(r),a=this._extractSvgIconFromSet(s,e,r.options);if(a)return a}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(I(t=>e.svgText=t),v(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Q(null):this._fetchIcon(e).pipe(I(t=>e.svgText=t))}_extractSvgIconFromSet(e,t,n){let r=e.querySelector(`[id="${t}"]`);if(!r)return null;let s=r.cloneNode(!0);if(s.removeAttribute("id"),s.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(s,n);if(s.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(s),n);let a=this._svgElementFromString(Z("<svg></svg>"));return a.appendChild(s),this._setSvgAttributes(a,n)}_svgElementFromString(e){let t=this._document.createElement("DIV");t.innerHTML=e;let n=t.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(e){let t=this._svgElementFromString(Z("<svg></svg>")),n=e.attributes;for(let r=0;r<n.length;r++){let{name:s,value:a}=n[r];s!=="id"&&t.setAttribute(s,a)}for(let r=0;r<e.childNodes.length;r++)e.childNodes[r].nodeType===this._document.ELEMENT_NODE&&t.appendChild(e.childNodes[r].cloneNode(!0));return t}_setSvgAttributes(e,t){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),t&&t.viewBox&&e.setAttribute("viewBox",t.viewBox),e}_fetchIcon(e){let{url:t,options:n}=e,r=n?.withCredentials??!1;if(!this._httpClient)throw St();if(t==null)throw Error(`Cannot fetch icon from URL "${t}".`);let s=this._sanitizer.sanitize(H.RESOURCE_URL,t);if(!s)throw ut(t);let a=this._inProgressUrlFetches.get(s);if(a)return a;let f=this._httpClient.get(s,{responseType:"text",withCredentials:r}).pipe(v(p=>Z(p)),Ne(()=>this._inProgressUrlFetches.delete(s)),ke());return this._inProgressUrlFetches.set(s,f),f}_addSvgIconConfig(e,t,n){return this._svgIconConfigs.set(ht(e,t),n),this}_addSvgIconSetConfig(e,t){let n=this._iconSetConfigs.get(e);return n?n.push(t):this._iconSetConfigs.set(e,[t]),this}_svgElementFromConfig(e){if(!e.svgElement){let t=this._svgElementFromString(e.svgText);this._setSvgAttributes(t,e.options),e.svgElement=t}return e.svgElement}_getIconConfigFromResolvers(e,t){for(let n=0;n<this._resolvers.length;n++){let r=this._resolvers[n](t,e);if(r)return At(r)?new y(r.url,null,r.options):new y(r,null)}}static \u0275fac=function(t){return new(t||i)(J(Ze,8),J(ce),J(S,8),J(G))};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function de(i){return i.cloneNode(!0)}function ht(i,o){return i+":"+o}function At(i){return!!(i.url&&i.options)}var Ee;try{Ee=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Ee=!1}var ue=(()=>{class i{_platformId=h(re);isBrowser=this._platformId?ae(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Ee)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Me(i){return Array.isArray(i)?i:[i]}var pt=new Set,L,Tt=(()=>{class i{_platform=h(ue);_nonce=h(Be,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Ft}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&Ot(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Ot(i,o){if(!pt.has(i))try{L||(L=document.createElement("style"),o&&L.setAttribute("nonce",o),L.setAttribute("type","text/css"),document.head.appendChild(L)),L.sheet&&(L.sheet.insertRule(`@media ${i} {body{ }}`,0),pt.add(i))}catch(e){console.error(e)}}function Ft(i){return{matches:i==="all"||i==="",media:i,addListener:()=>{},removeListener:()=>{}}}var _t=(()=>{class i{_mediaMatcher=h(Tt);_zone=h(pe);_queries=new Map;_destroySubject=new te;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return gt(Me(e)).some(n=>this._registerQuery(n).mql.matches)}observe(e){let n=gt(Me(e)).map(s=>this._registerQuery(s).observable),r=Te(n);return r=Oe(r.pipe(ie(1)),r.pipe(Re(1),ne(0))),r.pipe(v(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:f,query:p})=>{a.matches=a.matches||f,a.breakpoints[p]=f}),a}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);let t=this._mediaMatcher.matchMedia(e),r={observable:new K(s=>{let a=f=>this._zone.run(()=>s.next(f));return t.addListener(a),()=>{t.removeListener(a)}}).pipe(Pe(t),v(({matches:s})=>({query:e,matches:s})),Le(this._destroySubject)),mql:t};return this._queries.set(e,r),r}static \u0275fac=function(t){return new(t||i)};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function gt(i){return i.map(o=>o.split(",")).reduce((o,e)=>o.concat(e)).map(o=>o.trim())}var T=function(i){return i[i.NONE=0]="NONE",i[i.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",i[i.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",i}(T||{}),bt="cdk-high-contrast-black-on-white",Ct="cdk-high-contrast-white-on-black",we="cdk-high-contrast-active",ye=(()=>{class i{_platform=h(ue);_hasCheckedHighContrastMode;_document=h(S);_breakpointSubscription;constructor(){this._breakpointSubscription=h(_t).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return T.NONE;let e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);let t=this._document.defaultView||window,n=t&&t.getComputedStyle?t.getComputedStyle(e):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(e.remove(),r){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return T.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return T.BLACK_ON_WHITE}return T.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let e=this._document.body.classList;e.remove(we,bt,Ct),this._hasCheckedHighContrastMode=!0;let t=this.getHighContrastMode();t===T.BLACK_ON_WHITE?e.add(we,bt):t===T.WHITE_ON_BLACK&&e.add(we,Ct)}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Ie=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=k({type:i});static \u0275inj=F({})}return i})();var Se=(()=>{class i{constructor(){h(ye)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(t){return new(t||i)};static \u0275mod=k({type:i});static \u0275inj=F({imports:[Ie,Ie]})}return i})();var kt=["*"],Rt=new Y("MAT_ICON_DEFAULT_OPTIONS"),Pt=new Y("mat-icon-location",{providedIn:"root",factory:Dt});function Dt(){let i=h(S),o=i?i.location:null;return{getPathname:()=>o?o.pathname+o.search:""}}var vt=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Lt=vt.map(i=>`[${i}]`).join(", "),Bt=/^url\(['"]?#(.*?)['"]?\)$/,xt=(()=>{class i{_elementRef=h(fe);_iconRegistry=h(ft);_location=h(Pt);_errorHandler=h(G);_defaultColor;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(e){let t=this._cleanupFontValue(e);t!==this._fontSet&&(this._fontSet=t,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(e){let t=this._cleanupFontValue(e);t!==this._fontIcon&&(this._fontIcon=t,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=ee.EMPTY;constructor(){let e=h(new Ye("aria-hidden"),{optional:!0}),t=h(Rt,{optional:!0});t&&(t.color&&(this.color=this._defaultColor=t.color),t.fontSet&&(this.fontSet=t.fontSet)),e||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];let t=e.split(":");switch(t.length){case 1:return["",t[0]];case 2:return t;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let e=this._elementsWithExternalReferences;if(e&&e.size){let t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();let t=this._location.getPathname();this._previousPath=t,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(t),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){let e=this._elementRef.nativeElement,t=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();t--;){let n=e.childNodes[t];(n.nodeType!==1||n.nodeName.toLowerCase()==="svg")&&n.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let e=this._elementRef.nativeElement,t=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(n=>n.length>0);this._previousFontSetClass.forEach(n=>e.classList.remove(n)),t.forEach(n=>e.classList.add(n)),this._previousFontSetClass=t,this.fontIcon!==this._previousFontIconClass&&!t.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return typeof e=="string"?e.trim().split(" ")[0]:e}_prependPathToReferences(e){let t=this._elementsWithExternalReferences;t&&t.forEach((n,r)=>{n.forEach(s=>{r.setAttribute(s.name,`url('${e}#${s.value}')`)})})}_cacheChildrenWithExternalReferences(e){let t=e.querySelectorAll(Lt),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<t.length;r++)vt.forEach(s=>{let a=t[r],f=a.getAttribute(s),p=f?f.match(Bt):null;if(p){let C=n.get(a);C||(C=[],n.set(a,C)),C.push({name:s,value:p[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){let[t,n]=this._splitIconName(e);t&&(this._svgNamespace=t),n&&(this._svgName=n),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(n,t).pipe(ie(1)).subscribe(r=>this._setSvgElement(r),r=>{let s=`Error retrieving icon ${t}:${n}! ${r.message}`;this._errorHandler.handleError(new Error(s))})}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=oe({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(t,n){t&2&&(ge("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),ze(n.color?"mat-"+n.color:""),We("mat-icon-inline",n.inline)("mat-icon-no-color",n.color!=="primary"&&n.color!=="accent"&&n.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",xe],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],ngContentSelectors:kt,decls:1,vars:0,template:function(t,n){t&1&&(Ve(),$e(0))},styles:[`mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}
`],encapsulation:2,changeDetection:0})}return i})(),Et=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=k({type:i});static \u0275inj=F({imports:[Se,Se]})}return i})();var me=class i{constructor(o){this.sanitizer=o}transform(o){return this.sanitizer.bypassSecurityTrustHtml(o)}static \u0275fac=function(e){return new(e||i)(N(ce,16))};static \u0275pipe=Qe({name:"safeHtml",type:i,pure:!0})};var Qt=(i,o)=>o.id;function jt(i,o){i&1&&(c(0,"mat-icon"),d(1,"visibility"),l(),d(2," Voir l'aper\xE7u du QCM "))}function Ht(i,o){i&1&&(c(0,"mat-icon"),d(1,"edit"),l(),d(2," Revenir au mode \xE9dition "))}function Vt(i,o){i&1&&(c(0,"div",4)(1,"p"),d(2,'Cliquez sur "Ajouter une question" pour commencer \xE0 cr\xE9er votre QCM.'),l()())}function $t(i,o){if(i&1){let e=D();c(0,"input",23),z("ngModelChange",function(n){g(e);let r=m(2).$implicit;return W(r.correctAnswerIndex,n)||(r.correctAnswerIndex=n),_(n)}),x("ngModelChange",function(){g(e);let n=m(2).$implicit,r=m(2);return _(r.onAnswerUpdate(n))}),l()}if(i&2){let e=m().$index,t=m().$implicit;V("name","correctAnswerEditor_"+t.id)("value",e),$("ngModel",t.correctAnswerIndex)}}function Wt(i,o){if(i&1){let e=D();c(0,"input",24),z("ngModelChange",function(n){g(e);let r=m().$implicit;return W(r.isCorrect,n)||(r.isCorrect=n),_(n)}),x("ngModelChange",function(){g(e);let n=m(2).$implicit,r=m(2);return _(r.onAnswerUpdate(n))}),l()}if(i&2){let e=m().$implicit;$("ngModel",e.isCorrect)}}function zt(i,o){if(i&1){let e=D();c(0,"div",17)(1,"label"),R(2,$t,1,3,"input",19)(3,Wt,1,1,"input",20),c(4,"input",21),z("ngModelChange",function(n){let r=g(e).$implicit;return W(r.text,n)||(r.text=n),_(n)}),x("ngModelChange",function(){g(e);let n=m().$implicit,r=m(2);return _(r.onAnswerUpdate(n))}),l()(),c(5,"button",22),x("click",function(){let n=g(e).$index,r=m().$implicit,s=m(2);return r.answers.splice(n,1),_(s.onAnswerUpdate(r))}),c(6,"mat-icon"),d(7,"cancel"),l()()()}if(i&2){let e=o.$implicit,t=o.$index,n=m().$implicit;b(2),P(n.type==="radio"?2:3),b(2),V("placeholder",se("R\xE9ponse ",t+1)),$("ngModel",e.text)}}function Ut(i,o){if(i&1){let e=D();c(0,"div",5)(1,"div",7)(2,"h3"),d(3),l(),c(4,"button",8),x("click",function(){let n=g(e).$implicit,r=m(2);return _(r.removeQuestion(n.id))}),c(5,"mat-icon"),d(6,"delete"),l(),d(7," Supprimer la question "),l()(),c(8,"div",9)(9,"label"),d(10,"Type de question:"),l(),c(11,"select",10),z("ngModelChange",function(n){let r=g(e).$implicit;return W(r.type,n)||(r.type=n),_(n)}),x("ngModelChange",function(){let n=g(e).$implicit,r=m(2);return _(r.onQuestionTypeChange(n))}),c(12,"option",11),d(13,"Choix unique (Radio)"),l(),c(14,"option",12),d(15,"Choix multiples (Checkbox)"),l()()(),c(16,"div",13)(17,"label",14),d(18,"Texte de la question:"),l(),c(19,"textarea",15),z("ngModelChange",function(n){let r=g(e).$implicit;return W(r.text,n)||(r.text=n),_(n)}),x("ngModelChange",function(){let n=g(e).$implicit,r=m(2);return _(r.onAnswerUpdate(n))}),l()(),c(20,"div",16)(21,"h4"),d(22,"R\xE9ponses:"),l(),_e(23,zt,8,4,"div",17,je),c(25,"button",18),x("click",function(){let n=g(e).$implicit,r=m(2);return n.answers.push({text:"",isCorrect:!1}),_(r.onAnswerUpdate(n))}),c(26,"mat-icon"),d(27,"add"),l(),d(28," Ajouter une r\xE9ponse "),l()()()}if(i&2){let e=o.$implicit,t=o.$index;b(3),Ke("Question ",t+1,"."),b(8),$("ngModel",e.type),b(6),V("for",se("questionText_",e.id)),b(2),V("id",se("questionText_",e.id)),$("ngModel",e.text),b(4),be(e.answers)}}function Kt(i,o){if(i&1){let e=D();R(0,Vt,3,0,"div",4),_e(1,Ut,29,7,"div",5,Qt),c(3,"button",6),x("click",function(){g(e);let n=m();return _(n.addQuestion())}),c(4,"mat-icon"),d(5,"add_circle"),l(),d(6," Ajouter une question "),l()}if(i&2){let e=m();P(e.questions.length===0?0:-1),b(),be(e.questions)}}function Yt(i,o){i&1&&(c(0,"p",4),d(1,"Aucune question n'a \xE9t\xE9 cr\xE9\xE9e pour le QCM."),l())}function Jt(i,o){if(i&1){let e=D();c(0,"div",3)(1,"h2"),d(2,"QCM (Quiz \xE0 Choix Multiples)"),l(),c(3,"p"),d(4,"R\xE9pondez aux questions suivantes en cochant la bonne r\xE9ponse."),l(),R(5,Yt,2,0,"p",4),He(6,"div",25),Ce(7,"safeHtml"),c(8,"h3"),d(9,"R\xE9ponses JSON (pour l'API):"),l(),c(10,"pre"),d(11),Ce(12,"json"),l(),c(13,"button",26),x("click",function(){g(e);let n=m();return _(n.submitQcmToApi())}),c(14,"mat-icon"),d(15,"send"),l(),d(16," Envoyer le QCM "),l()()}if(i&2){let e=m();b(5),P(e.questions.length===0?5:-1),b(),V("innerHTML",ve(7,3,e.generatedQcmHtml),qe),b(5),Ue(ve(12,5,e.qcmAnswersJson))}}var Mt=class i{constructor(o,e,t,n){this.route=o;this.courseService=e;this.platformId=t;this.document=n;this.isBrowser=ae(t)}questions=[];nextQuestionId=1;showPreview=!0;isBrowser;generatedQcmHtml="";qcmAnswersJson={};changesRequiringGeneration=new te;subscriptions=new ee;formationSlug="";moduleSlug="";sectionName="QCM";filename="1.html";ngOnInit(){this.subscriptions.add(this.route.queryParams.pipe(Fe(o=>o.formationSlug&&o.moduleSlug),De(o=>{this.formationSlug=o.formationSlug||"",this.moduleSlug=o.moduleSlug||"",this.sectionName=o.sectionName||"QCM",this.filename=o.filename||"1.html",this.questions=[],this.generatedQcmHtml='<p class="loading-message">Chargement du QCM...</p>',this.qcmAnswersJson={},this.nextQuestionId=1;let e=this.courseService.getCourseModuleDataHTML(this.formationSlug,this.moduleSlug,[this.sectionName]).pipe(v(n=>n[this.sectionName]),E(n=>(console.error("Error fetching QCM HTML:",n),M(()=>new Error("Failed to load QCM HTML"))))),t=this.courseService.getCourseModuleDataJSON(this.formationSlug,this.moduleSlug,this.sectionName).pipe(E(n=>(console.error("Error fetching QCM JSON:",n),M(()=>new Error("Failed to load QCM JSON")))));return j([e,t]).pipe(I(([n,r])=>{console.log("Fetched HTML...",n),console.log("Fetched JSON...")}),E(n=>(console.error("Failed to load QCM data during switchMap:",n),new K(r=>{r.next(["",{}]),r.complete()}))))})).subscribe(([o,e])=>{o&&e&&Object.keys(e).length>0?(this.questions=this.parseQcmData(o,e),this.nextQuestionId=this.questions.length>0?Math.max(...this.questions.map(t=>t.id))+1:1):(console.warn("No QCM data found or empty. Initializing empty questions."),this.questions=[],this.nextQuestionId=1),this.generateQcmData()},o=>{console.error("Error in QCM data loading subscription:",o),this.questions=[],this.nextQuestionId=1,this.generateQcmData()})),this.subscriptions.add(this.changesRequiringGeneration.pipe(ne(400)).subscribe(()=>{this.showPreview&&this.generateQcmData()}))}ngOnDestroy(){this.subscriptions.unsubscribe()}getQcmDataObservables(o,e,t){let n=this.courseService.getCourseModuleDataHTML(o,e,[t]).pipe(v(s=>s[t]),E(s=>(console.error("Error fetching QCM HTML:",s),M(()=>new Error("Failed to load QCM HTML"))))),r=this.courseService.getCourseModuleDataJSON(o,e,t).pipe(E(s=>(console.error("Error fetching QCM JSON:",s),M(()=>new Error("Failed to load QCM JSON")))));return j([n,r]).pipe(I(([s,a])=>{console.log("Fetched HTML...",s),console.log("Fetched JSON...")}),E(s=>(console.error("Failed to load QCM data:",s),new K(a=>{a.next(["",{}]),a.complete()}))))}parseQcmData(o,e){if(!this.isBrowser)return console.warn("DOMParser is not available on the server. Skipping HTML parsing."),[];let t=[],s=new DOMParser().parseFromString(o,"text/html").querySelectorAll("body > h3");for(let a of Array.from(s)){let f=a.textContent?.match(/QCM (\d+)\./);if(!f){console.warn("Could not parse question ID from header:",a.textContent);continue}let p=parseInt(f[1],10),C="",u=a.nextElementSibling;if(u&&u.tagName==="P")C=u.innerHTML.trim(),u=u.nextElementSibling,u&&u.tagName==="PRE"&&(C+=u.outerHTML.trim(),u=u.nextElementSibling?.nextElementSibling||u.nextElementSibling,console.log("nextpre",u?.nextElementSibling));else for(console.warn(`Could not find initial question text (paragraph with strong) for QCM ${p}.`);u&&u.tagName!=="LABEL"&&u.tagName!=="HR";)u=u.nextElementSibling,console.log("if not pre",u);let U=[],Ae="radio";for(;u&&u.tagName==="LABEL";){let O=u.querySelector("input");if(O){Ae=O.type;let q=O.value,X=u.innerHTML.replace(/<input[^>]*>\s*[A-Z]\.\s*/i,"").trim();U.push({text:X,isCorrect:!1})}u=u.nextElementSibling}let B={id:p,type:Ae,text:C,answers:U},he=e[`q${p}`];if(B.type==="radio"){let O=he,q=U.findIndex((X,wt)=>this.getAnswerLetter(wt)===O);q!==-1?(B.answers[q].isCorrect=!0,B.correctAnswerIndex=q):B.correctAnswerIndex=-1}else{let O=Array.isArray(he)?he:[];B.answers.forEach((q,X)=>{O.includes(this.getAnswerLetter(X))&&(q.isCorrect=!0)})}t.push(B)}return t}signalChange(){this.changesRequiringGeneration.next()}addQuestion(){this.questions.push({id:this.nextQuestionId++,type:"radio",text:"",answers:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],correctAnswerIndex:-1}),this.signalChange()}removeQuestion(o){this.questions=this.questions.filter(e=>e.id!==o),this.nextQuestionId=this.questions.length>0?Math.max(...this.questions.map(e=>e.id))+1:1,this.signalChange()}togglePreview(){this.showPreview=!this.showPreview,this.showPreview&&this.generateQcmData()}onQuestionTypeChange(o){o.type==="radio"?((o.correctAnswerIndex===void 0||o.correctAnswerIndex===-1)&&(o.correctAnswerIndex=o.answers.length>0?0:-1),o.answers.forEach(e=>e.isCorrect=!1),o.correctAnswerIndex!==-1&&o.correctAnswerIndex<o.answers.length&&(o.answers[o.correctAnswerIndex].isCorrect=!0)):(delete o.correctAnswerIndex,o.answers.forEach(e=>e.isCorrect=!1)),this.signalChange()}onAnswerUpdate(o){o.type==="radio"&&o.answers.forEach((e,t)=>{e.isCorrect=t===o.correctAnswerIndex}),this.signalChange()}getAnswerLetter(o){return String.fromCharCode(65+o)}generateQcmData(){let o="<h2>QCM (Quiz \xE0 Choix Multiples)</h2><p>R\xE9pondez aux questions suivantes en cochant la bonne r\xE9ponse.</p><hr />",e={};if(this.questions.length===0){this.generatedQcmHtml=`<p class="no-questions-message">Aucune question n'a \xE9t\xE9 cr\xE9\xE9e pour le QCM.</p>`,this.qcmAnswersJson={};return}this.questions.forEach((t,n)=>{t.type==="radio"&&t.answers.forEach((f,p)=>{f.isCorrect=p===t.correctAnswerIndex}),o+=`<h3>QCM ${t.id}.</h3>`,o+=`<p>${t.text}</p>`;let r="",s=[];t.answers.forEach((f,p)=>{let C=this.getAnswerLetter(p),u=t.type,U=`q${t.id}`;r+=`<label><input type="${u}" name="${U}" value="${C}" /> ${C}. ${f.text}</label>`,f.isCorrect&&s.push(C)}),o+=r,o+="<hr />";let a=`q${t.id}`;t.type==="radio"?e[a]=s.length>0?s[0]:"":e[a]=s}),this.generatedQcmHtml=o,this.qcmAnswersJson=e,console.log("Generated HTML and JSON")}updateOrCreateFile(o,e,t){return this.courseService.updateCoursePartFile(this.formationSlug,this.moduleSlug,this.sectionName,o,e,t).pipe(E(n=>n.status===404?(console.warn(`${o} not found, attempting to create.`),this.courseService.createCoursePartFile(this.formationSlug,this.moduleSlug,this.sectionName,o,e,t)):(console.error(`Error updating ${o}:`,n),M(()=>n))))}submitQcmToApi(){if(this.generateQcmData(),!this.formationSlug||!this.moduleSlug||!this.sectionName){console.error("Cannot submit QCM: Missing course, module, or section slugs."),alert("Erreur: Impossible de soumettre le QCM. Informations manquantes.");return}let o=JSON.stringify(this.qcmAnswersJson,null,2),e="1.html",t="1.json",n=this.updateOrCreateFile(e,this.generatedQcmHtml,"text/html"),r=this.updateOrCreateFile(t,o,"application/json");this.subscriptions.add(j([n,r]).pipe(I(()=>{console.log("QCM HTML et JSON mis \xE0 jour avec succ\xE8s !"),alert("QCM enregistr\xE9 avec succ\xE8s !")}),E(s=>(console.error("Erreur lors de la soumission du QCM:",s),alert("\xC9chec de l'enregistrement du QCM. Veuillez consulter la console pour les d\xE9tails."),M(()=>s)))).subscribe())}static \u0275fac=function(e){return new(e||i)(N(Xe),N(et),N(re),N(S))};static \u0275cmp=oe({type:i,selectors:[["app-qcm-builder"]],decls:9,vars:3,consts:[[1,"qcm-builder-container"],[1,"controls"],[1,"toggle-view-button",3,"click"],[1,"generated-qcm-preview"],[1,"no-questions-message"],[1,"question-editor-card"],[1,"add-question-button",3,"click"],[1,"question-header"],[1,"remove-question-button",3,"click"],[1,"question-type-selection"],[3,"ngModelChange","ngModel"],["value","radio"],["value","checkbox"],[1,"question-text-area"],[3,"for"],["rows","3","placeholder","R\xE9digez votre question ici...",3,"ngModelChange","id","ngModel"],[1,"answers-section"],[1,"answer-item"],[1,"add-answer-button",3,"click"],["type","radio",3,"name","value","ngModel"],["type","checkbox",3,"ngModel"],["type","text",3,"ngModelChange","ngModel","placeholder"],[1,"remove-answer-button",3,"click"],["type","radio",3,"ngModelChange","name","value","ngModel"],["type","checkbox",3,"ngModelChange","ngModel"],[3,"innerHTML"],[1,"submit-qcm-button",3,"click"]],template:function(e,t){e&1&&(c(0,"div",0)(1,"h2"),d(2,"Cr\xE9ateur de QCM"),l(),c(3,"div",1)(4,"button",2),x("click",function(){return t.togglePreview()}),R(5,jt,3,0)(6,Ht,3,0),l()(),R(7,Kt,7,1),R(8,Jt,17,7,"div",3),l()),e&2&&(b(5),P(t.showPreview?6:5),b(2),P(t.showPreview?-1:7),b(),P(t.showPreview?8:-1))},dependencies:[Ge,Je,lt,at,ct,nt,tt,st,ot,it,rt,Et,xt,me],styles:[".qcm-builder-container[_ngcontent-%COMP%]{font-family:Arial,sans-serif;max-width:900px;margin:20px auto;padding:20px;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 4px #0000001a;background-color:#fff}h2[_ngcontent-%COMP%]{color:#333;text-align:center;margin-bottom:20px}.controls[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.toggle-view-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#6c757d;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:16px;transition:background-color .3s ease;display:inline-flex;align-items:center;gap:8px}.toggle-view-button[_ngcontent-%COMP%]:hover{background-color:#5a6268}.toggle-view-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:8px}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.add-question-button[_ngcontent-%COMP%]{display:block;width:fit-content;margin:0 auto 20px;padding:10px 20px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:16px;transition:background-color .3s ease}.add-question-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.add-question-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.no-questions-message[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic;margin-top:30px;padding:20px;border:1px dashed #ccc;border-radius:5px;background-color:#f9f9f9}.question-editor-card[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;padding:15px;margin-bottom:25px;background-color:#fcfcfc;box-shadow:0 1px 3px #0000000d}.question-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.question-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#555}.remove-question-button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;border-radius:4px;padding:6px 12px;cursor:pointer;font-size:14px;transition:background-color .3s ease}.remove-question-button[_ngcontent-%COMP%]:hover{background-color:#c82333}.remove-question-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.question-type-selection[_ngcontent-%COMP%]{margin-bottom:15px}.question-type-selection[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:10px;font-weight:700;color:#555}.question-type-selection[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px;font-size:15px}.question-text-area[_ngcontent-%COMP%]{margin-bottom:20px}.question-text-area[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:700;color:#555}.question-text-area[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:16px;box-sizing:border-box;resize:vertical}.answers-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:0;margin-bottom:10px;color:#555}.answer-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.answer-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1;cursor:pointer}.answer-item[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%], .answer-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:8px;transform:scale(1.2)}.answer-item[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{flex-grow:1;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:15px;margin-left:5px}.remove-answer-button[_ngcontent-%COMP%]{background-color:#ffc107;color:#333;border:none;border-radius:4px;padding:4px;margin-left:10px;cursor:pointer;font-size:14px;transition:background-color .3s ease;flex-shrink:0;display:flex;align-items:center;justify-content:center;width:32px;height:32px}.remove-answer-button[_ngcontent-%COMP%]:hover{background-color:#e0a800}.remove-answer-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#333;margin:0}.add-answer-button[_ngcontent-%COMP%]{padding:8px 15px;background-color:#28a745;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:14px;transition:background-color .3s ease;margin-top:10px}.add-answer-button[_ngcontent-%COMP%]:hover{background-color:#218838}.add-answer-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.generated-qcm-preview[_ngcontent-%COMP%]{margin-top:40px;border-top:2px solid #eee;padding-top:30px}.generated-qcm-preview[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#007bff;margin-bottom:10px}.generated-qcm-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:15px}.generated-qcm-preview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;margin-top:25px;margin-bottom:10px}.generated-qcm-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:1.1em;color:#444}.generated-qcm-preview[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:8px;cursor:pointer;color:#333}.generated-qcm-preview[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%], .generated-qcm-preview[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:10px;transform:scale(1.1)}.generated-qcm-preview[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:0;height:1px;background:#eee;margin:30px 0}.generated-qcm-preview[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#f0f0f0;padding:2px 5px;border-radius:3px;font-family:Courier New,Courier,monospace;color:#c7254e}pre[_ngcontent-%COMP%]{background-color:#f8f8f8;border:1px solid #ddd;border-radius:4px;padding:10px;margin:15px 0;overflow-x:auto;font-family:Courier New,Courier,monospace;font-size:.9em;color:#333}.submit-qcm-button[_ngcontent-%COMP%]{margin-top:30px;padding:12px 25px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:18px;font-weight:700;transition:background-color .3s ease;display:inline-flex;align-items:center;gap:10px;text-align:center}.submit-qcm-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.submit-qcm-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:24px;width:24px;height:24px}"]})};export{Mt as QcmBuilder};
